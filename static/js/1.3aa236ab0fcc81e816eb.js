webpackJsonp([1],{Cdx3:function(t,e,s){var i=s("sB3e"),a=s("lktj");s("uqUo")("keys",function(){return function(t){return a(i(t))}})},HVeR:function(t,e){},fZjL:function(t,e,s){t.exports={default:s("jFbC"),__esModule:!0}},jFbC:function(t,e,s){s("Cdx3"),t.exports=s("FeBl").Object.keys},uqUo:function(t,e,s){var i=s("kM2E"),a=s("FeBl"),n=s("S82l");t.exports=function(t,e){var s=(a.Object||{})[t]||Object[t],o={};o[t]=e(s),i(i.S+i.F*n(function(){s(1)}),"Object",o)}},xJsL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("fZjL"),a=s.n(i),n=["validating","warning","error","success"],o={name:"test",data:function(){return{code1:"",code2:"",code3:"",code4:"",code5:"",code6:"",tip_visible:!0,login_box_style:{height:document.documentElement.clientHeight+"px"},user_name:"",user_pwd:"",user_mail:"@mytopfun.com",validate:{user_name:{status:"",help:""},user_pwd:{status:"",help:""},user_mail:{status:"",help:""}},is_remeber:!0,tab:"1",code_btn_text:"发送验证码",get_code_btn:!0,show_code_input:!1,numReg:/^\d{1}$/,qr_id:"",show_qr:!1,login_qr_img:"static/qrcode.png",switch_text:"扫码登录",timmer:null}},methods:{visibleChange:function(t){this.tip_visible=!0},onChange:function(t){console.log("changed",t)},getCode:function(){var t=this;this.code_btn_text="验证码发送中...";var e={user_mail:this.user_mail};this.$http.post("index.php?a=Admin&m=getCode",e).then(function(e){200==e.data.status?(t.$success({title:"验证码发送成功",content:"验证码已发送至"+t.user_mail+"，5分钟内有效，请及时登录获取，1分钟后可重新发送验证码..."}),t.show_code_input=!0,t.$nextTick(function(){t.$refs.input1.focus()}),t.get_code_btn=!0,t.handleMins()):(t.code_btn_text="发送验证码",t.setValidate("user_mail",n[2],e.data.msg))})},handleMins:function(){var t=this,e=60,s=setInterval(function(){--e<1?(t.get_code_btn=!1,t.code_btn_text="发送验证码",clearInterval(s)):t.code_btn_text=e+"后重新发送"},1e3)},callback:function(t){this.tab=t},handleSubmit:function(){var t=this;if("1"==this.tab){if(0!==this.checkBeforeLogin())return!1;this.user_info.game=this.$game,this.$http.post("index.php?a=Admin&m=login",this.user_info).then(function(e){t.handleSuccess(e.data)})}"2"==this.tab&&this.submitCode()},setValidate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.validate[t].status=e,this.validate[t].help=s},checkBeforeLogin:function(){var t=this,e=0;return a()(this.user_info).forEach(function(s){""==t.user_info[s]&&(t.setValidate(s,n[1],"此处不能为空"),e++)}),e},handleSuccess:function(t){var e=this;switch(t.status){case 200:localStorage.setItem(this.$game_token,t.token),localStorage.setItem(this.$game_user_name,this.user_name);var s=this.$success({title:"验证成功!",content:"将在1秒后跳转至后台主界面~"});setTimeout(function(){s.destroy(),e.$router.push("/")},1e3);break;case 702:this.$error({title:"错误",content:"参数不足..."});break;case 901:this.setValidate("user_name",n[2],"用户不存在");break;case 902:this.setValidate("user_pwd",n[2],"密码错误");break;case 905:this.$error({title:"验证码错误",content:"验证码错误或已过期，请重新获取..."}),this.get_code_btn=!1,this.code_btn_text="发送验证码";break;default:this.$error({title:"未知错误",content:"登录时发生了未知的错误，请联系系统管理员..."})}return!1},submitCode:function(){var t=this,e=this.code1+this.code2+this.code3+this.code4+this.code5+this.code6,s={user_mail:this.user_mail,code:e,game:this.$game};this.$http.post("index.php?a=Admin&m=checkCode",s).then(function(e){t.user_name=e.data.name,t.handleSuccess(e.data)})},handleSwitch:function(){this.show_qr=!this.show_qr,this.show_qr?(this.switch_text="密码登录",this.login_qr_img="static/computer.png",this.getQRCode()):(clearInterval(this.timmer),this.switch_text="扫码登录",this.login_qr_img="static/qrcode.png")},getQRCode:function(){var t=this;this.$http.get("index.php?a=Admin&m=getUniqueQRCode").then(function(e){t.qr_id=e.data.id,t.show_qr=!0,t.$nextTick(function(){t.createQR()})})},createQR:function(){var t=this,e=document.getElementById("qrccode-canvas");console.log(this.qr_id),this.QRCode.toCanvas(e,this.$QR_login_api+this.qr_id,function(t){}),this.timmer=setInterval(function(){t.getLoginInfo()},2e3)},getLoginInfo:function(){var t=this,e={id:this.qr_id,game:this.$game};this.$http.get("index.php?a=Admin&m=getLoginInfo",{params:e}).then(function(e){switch(console.log(e.data),e.data.status){case 200:clearInterval(t.timmer),t.user_name=e.data.name,localStorage.setItem(t.$game_token,e.data.token),localStorage.setItem(t.$game_user_name,t.user_name);var s=t.$success({title:"验证成功!",content:"将在1秒后跳转至后台主界面~"});setTimeout(function(){s.destroy(),t.$router.push("/")},1e3);break;case 702:t.$error({title:"错误",content:"参数不足..."}),clearInterval(t.timmer);break;case 901:t.$error({title:"错误",content:"被非法的用户扫码..."}),clearInterval(t.timmer);break;case 801:t.$error({title:"错误",content:"二维码已过期..."}),clearInterval(t.timmer)}return!1})}},computed:{user_info:function(){return{user_name:this.user_name,user_pwd:this.user_pwd}}},watch:{user_name:function(t){""==t?this.setValidate("user_name",n[1],"用户名不能为空"):this.setValidate("user_name")},user_pwd:function(t){""==t?this.setValidate("user_pwd",n[1],"密码不能为空"):this.setValidate("user_pwd")},user_mail:function(t){var e=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/.test(t);!e||(this.get_code_btn=!1),e&&this.setValidate("user_mail")},code1:function(t){var e=this;""!=t&&this.numReg.test(t)?this.$nextTick(function(){e.$refs.input2.focus()}):this.code1=""},code2:function(t){var e=this;""!=t&&this.numReg.test(t)?this.$nextTick(function(){e.$refs.input3.focus()}):this.code2=""},code3:function(t){var e=this;""!=t&&this.numReg.test(t)?this.$nextTick(function(){e.$refs.input4.focus()}):this.code3=""},code4:function(t){var e=this;""!=t&&this.numReg.test(t)?this.$nextTick(function(){e.$refs.input5.focus()}):this.code4=""},code5:function(t){var e=this;""!=t&&this.numReg.test(t)?this.$nextTick(function(){e.$refs.input6.focus()}):this.code5=""},code6:function(t){""!=t&&this.numReg.test(t)?this.submitCode():this.code6=""}},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login-box",style:t.login_box_style},[s("div",[s("a-row",[s("a-col",{attrs:{xs:2,sm:4,md:6,lg:8,xl:10}}),t._v(" "),s("a-col",{attrs:{xs:20,sm:16,md:12,lg:8,xl:4}},[s("p",[t._v(t._s(t.$game_zch)+"项目管理后台")]),t._v(" "),s("br"),t._v(" "),s("div",{staticStyle:{position:"relative"}},[t.show_qr?t._e():s("a-form",{staticClass:"login-form"},[s("a-tabs",{attrs:{defaultActiveKey:"1"},on:{change:t.callback}},[s("a-tab-pane",{key:"1",attrs:{tab:"用户名/密码登录"}},[s("a-form-item",{attrs:{validateStatus:t.validate.user_name.status,help:t.validate.user_name.help}},[s("a-input",{attrs:{placeholder:"Username",size:"large","auto-focus":""},model:{value:t.user_name,callback:function(e){t.user_name=e},expression:"user_name"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t._v(" "),t.show_qr?t._e():s("a-form-item",{attrs:{validateStatus:t.validate.user_pwd.status,help:t.validate.user_pwd.help}},[s("a-input",{attrs:{type:"password",placeholder:"Password",size:"large"},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleSubmit(e):null}},model:{value:t.user_pwd,callback:function(e){t.user_pwd=e},expression:"user_pwd"}},[s("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1),t._v(" "),s("a-tab-pane",{key:"2",attrs:{tab:"邮箱验证码登录"}},[s("a-form-item",{attrs:{validateStatus:t.validate.user_mail.status,help:t.validate.user_mail.help}},[s("a-input-search",{attrs:{placeholder:"E-mail",size:"large","auto-focus":""},on:{search:t.getCode},model:{value:t.user_mail,callback:function(e){t.user_mail=e},expression:"user_mail"}},[s("a-button",{staticStyle:{"font-size":"12px"},attrs:{slot:"enterButton",disabled:t.get_code_btn},slot:"enterButton"},[t._v(t._s(t.code_btn_text))])],1)],1),t._v(" "),t.show_code_input?s("a-form-item",[s("a-row",{staticStyle:{"text-align":"center"},attrs:{type:"flex",justify:"space-around"}},[s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input1",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code1,callback:function(e){t.code1=e},expression:"code1"}})],1),t._v(" "),s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input2",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code2,callback:function(e){t.code2=e},expression:"code2"}})],1),t._v(" "),s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input3",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code3,callback:function(e){t.code3=e},expression:"code3"}})],1),t._v(" "),s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input4",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code4,callback:function(e){t.code4=e},expression:"code4"}})],1),t._v(" "),s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input5",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code5,callback:function(e){t.code5=e},expression:"code5"}})],1),t._v(" "),s("a-col",{attrs:{span:4}},[s("a-input",{ref:"input6",staticStyle:{width:"2.7rem"},attrs:{size:"large"},model:{value:t.code6,callback:function(e){t.code6=e},expression:"code6"}})],1)],1)],1):t._e()],1)],1),t._v(" "),s("a-form-item",{staticClass:"login-form-item"},[s("a-checkbox",{staticClass:"login-form-remeber",model:{value:t.is_remeber,callback:function(e){t.is_remeber=e},expression:"is_remeber"}},[t._v("自动登录")]),t._v(" "),s("a",{staticClass:"login-form-forgot"},[t._v("忘记密码")])],1),t._v(" "),s("a-button",{staticClass:"login-form-button",attrs:{type:"primary",size:"large"},on:{click:t.handleSubmit}},[t._v("登录")])],1),t._v(" "),t.show_qr?s("div",[s("canvas",{staticStyle:{"margin-top":"4rem"},attrs:{id:"qrccode-canvas"}})]):t._e(),t._v(" "),t.show_qr?s("div",[s("a-row",[s("a-col",{staticStyle:{"text-align":"right",padding:"0.1rem 0.5rem"},attrs:{span:12}},[s("a-icon",{staticStyle:{color:"#00c1de","font-size":"2rem"},attrs:{type:"scan"}})],1),t._v(" "),s("a-col",{staticStyle:{"font-size":"0.5rem","text-align":"left"},attrs:{span:10}},[s("p",{staticStyle:{margin:"0","font-size":"0.5rem"}},[t._v("打开"),s("span",{staticStyle:{color:"#00c1de","font-size":"0.5rem"}},[t._v("微信")])]),t._v(" "),s("p",{staticStyle:{margin:"0","font-size":"0.5rem"}},[t._v("扫一扫登录")])])],1)],1):t._e()],1),t._v(" "),s("div",{staticStyle:{position:"absolute",right:"0",top:"150px"}},[s("a-tooltip",{attrs:{placement:"left"},on:{visibleChange:t.visibleChange},model:{value:t.tip_visible,callback:function(e){t.tip_visible=e},expression:"tip_visible"}},[s("template",{slot:"title"},[s("span",{staticStyle:{color:"#00c1de"}},[t._v(t._s(t.switch_text))])]),t._v(" "),s("img",{staticStyle:{width:"3rem",height:"3rem"},attrs:{src:t.login_qr_img},on:{click:t.handleSwitch}})],2)],1),t._v(" "),s("footer",{staticClass:"footer"},[t._v("\r\n                    Copyright "),s("a-icon",{attrs:{type:"copyright"}}),t._v(" "+t._s((new Date).getFullYear())+" Shenzhen\r\n                ")],1)]),t._v(" "),s("a-col",{attrs:{xs:2,sm:4,md:6,lg:8,xl:10}})],1)],1)])},staticRenderFns:[]};var c=s("VU/8")(o,r,!1,function(t){s("HVeR")},"data-v-5e1bf5a5",null);e.default=c.exports}});