webpackJsonp([7],{aUl0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=[{title:"API_ID",dataIndex:"id"},{title:"所属游戏",dataIndex:"game",scopedSlots:{customRender:"game"}},{title:"API名称",dataIndex:"api_name"},{title:"API描述",dataIndex:"api_desc"},{title:"操作",key:"action",scopedSlots:{customRender:"action"}}],s={props:{game_id:{type:String,default:"0"}},data:function(){return{columns:i,loading:!1,data:[],pagination:{pageSize:10},alter:{message:"数据加载中!",type:"info"},visible:!1,api_name:"",api_desc:"",game:"1",edit_visible:!1,edit_id:0,edit_game_name:"",keyword:""}},computed:{table_data:function(){var t=this;return""==this.keyword?this.data:this.data.filter(function(e){return-1!=e.api_name.indexOf(t.keyword)||-1!=e.api_desc.indexOf(t.keyword)})}},methods:{showModal:function(){this.visible=!0},fetch:function(t){var e=this;this.$http.get("index.php?a=Api&m=getApiList&id="+t).then(function(t){e.loading=!1,200==t.data.status?(e.data=t.data.data,e.alter={message:"加载成功!",type:"success"}):e.alter={message:t.data.msg,type:"error"}})},editPermission:function(t){this.api_name=t.api_name,this.edit_id=t.id,this.api_desc=t.api_desc,this.edit_visible=!0},handleOk:function(){var t=this,e={api_name:this.api_name,api_desc:this.api_desc,game:this.game_id};return/^[a-zA-Z-_]{5,}$/.test(this.api_name)?""==this.api_desc?(this.$error({title:"非法的API描述",content:"不可以为空）..."}),!1):(this.visible=!1,this.$message.loading("注册中...",0),void this.$http.post("index.php?a=Api&m=addApi",e).then(function(e){t.$message.destroy(),200==e.data.status?(t.$success({title:"注册API成功!"}),t.fetch(t.game_id)):t.$message.error("注册API失败!",2)})):(this.$error({title:"非法的API名称",content:"必须是5位以上（字母，数字，下划线，减号）..."}),!1)},handleEdit:function(){var t=this,e={api_name:this.api_name,api_desc:this.api_desc,id:this.edit_id};return/^[a-zA-Z-_]{5,}$/.test(this.api_name)?""==this.api_desc?(this.$error({title:"非法的API描述",content:"不可以为空）..."}),!1):(this.edit_visible=!1,this.$message.loading("更新中...",0),void this.$http.post("index.php?a=Api&m=updateApi",e).then(function(e){t.$message.destroy(),200==e.data.status?(t.$success({title:"更新API成功!"}),t.fetch(t.game_id)):t.$message.error("更新API失败!",2)})):(this.$error({title:"非法的API名称",content:"必须是5位以上（字母，数字，下划线，减号）..."}),!1)},handleCancel:function(){this.visible=!1,this.edit_visible=!1,this.$message.destroy()},getGameName:function(t){var e=this;this.$http.get("index.php?a=Api&m=getGameName&id="+t).then(function(t){200==t.data.status?e.edit_game_name=t.data.name:e.$error({title:"非法的项目ID",content:"项目ID不存在或未注册..."})})}},mounted:function(){this.getGameName(this.game_id),this.fetch(this.game_id)}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"com-item"},[a("a-input-search",{staticStyle:{width:"200px"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t._v(" "),a("a-button",{attrs:{type:"danger"}},[t._v("\n        正在编辑【"),a("span",{staticStyle:{color:"#409EFF"}},[t._v(t._s(t.edit_game_name))]),t._v("】项目"),a("a-icon",{attrs:{type:"right"}})],1),t._v(" "),a("a-tooltip",{attrs:{placement:"rightBottom"}},[a("template",{slot:"title"},[a("span",[t._v("必须成功注册API后，才可访问资源!")])]),t._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:t.showModal}},[a("a-icon",{attrs:{type:"plus"}}),t._v("注册API")],1)],2),t._v(" "),a("a-alert",{staticStyle:{margin:"12px 0"},attrs:{message:t.alter.message,type:t.alter.type,showIcon:"",closable:""}}),t._v(" "),a("a-table",{attrs:{columns:t.columns,dataSource:t.table_data,pagination:t.pagination,loading:t.loading},scopedSlots:t._u([{key:"game",fn:function(e,i){return a("span",{},[t._v(t._s(t.edit_game_name))])}},{key:"action",fn:function(e,i){return a("span",{},[a("a-button",{attrs:{type:"dashed"},on:{click:function(a){t.editPermission(e)}}},[t._v("编辑")])],1)}}])}),t._v(" "),a("a-modal",{attrs:{title:"注册API"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("a-alert",{staticStyle:{"margin-bottom":"12px"},attrs:{message:"必须成功注册API后，才可访问资源!",banner:""}}),t._v(" "),a("a-form",[a("a-form-item",{staticStyle:{"margin-bottom":"12px"}},[a("a-input",{attrs:{placeholder:"请输入API名称"},model:{value:t.api_name,callback:function(e){t.api_name=e},expression:"api_name"}})],1),t._v(" "),a("a-form-item",{staticStyle:{"margin-bottom":"12px"}},[a("a-input",{attrs:{placeholder:"请输入API简要描述"},model:{value:t.api_desc,callback:function(e){t.api_desc=e},expression:"api_desc"}})],1)],1),t._v(" "),a("template",{slot:"footer"},[a("a-button",{on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("确认添加")])],1)],2),t._v(" "),a("a-modal",{attrs:{title:"编辑API"},model:{value:t.edit_visible,callback:function(e){t.edit_visible=e},expression:"edit_visible"}},[a("a-alert",{staticStyle:{"margin-bottom":"12px"},attrs:{message:"编辑后务必确保该API已经实现，否则会报404错误!",banner:""}}),t._v(" "),a("a-form",[a("a-form-item",{staticStyle:{"margin-bottom":"12px"}},[a("a-input",{model:{value:t.api_name,callback:function(e){t.api_name=e},expression:"api_name"}})],1),t._v(" "),a("a-form-item",{staticStyle:{"margin-bottom":"12px"}},[a("a-input",{model:{value:t.api_desc,callback:function(e){t.api_desc=e},expression:"api_desc"}})],1)],1),t._v(" "),a("template",{slot:"footer"},[a("a-button",{on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:t.handleEdit}},[t._v("确认修改")])],1)],2)],1)},staticRenderFns:[]},o=a("VU/8")(s,n,!1,null,null,null);e.default=o.exports}});